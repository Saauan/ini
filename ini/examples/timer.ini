
type Person = [firstNames:String*, lastName:String, height: Long]

process main() {
	@init() {
		i = 1
		suffix = "tutu"
		fns = ["Renaud", "Bruno", "Pierre"]
		p = Person[firstNames=fns, lastName="Pawlak", height=184]
		dict = []
		dict["key"] = "abc"
		println(fns)
		println(to_json(fns))
		println(fns[1])
		println(dict["key"])
		produce("test_channel"+suffix, "coucou "+i)
		produce("test_channel", i)
		produce("test_channel2", p)
		produce("test_channel3", fns)
		produce("test_channel4", dict)
	}
/*	@every[time=1000]() {
		println("tick "+(i++))
		produce("test_channel"+suffix, "coucou "+i)
		produce("test_channel", i)
		produce("test_channel2", p)
		produce("test_channel3", fns)
	}*/
	@consume[channel="test_channel"+suffix](v) {
		println("string value = "+v)
	}
	@consume[channel="test_channel"](v) {
		println("int value = "+v)
	}
	@consume[channel="test_channel2"](v) {
		println("person value = "+to_json(v))
	}
	@consume[channel="test_channel3"](v) {
		println("list value = "+to_json(v))
		println(v[1])
	}
	@consume[channel="test_channel4"](d) {
		println("dict value = "+to_json(d))
		println(d["key"])
	}
}
