
type Person = [firstName:String, lastName:String, height: Long]

process main() {
	@init() {
		i = 1
		suffix = "tutu"
		p = Person[firstName="Renaud", lastName="Pawlak", height=184]
	}
	@every[time=1000]() {
		println("tick "+(i++))
		produce("test_channel"+suffix, "coucou "+i)
		produce("test_channel", i)
		produce("test_channel2", p)
	}
	@consume[channel="test_channel"+suffix](v) {
		println("string value = "+v)
	}
	@consume[channel="test_channel"](v) {
		println("int value = "+v)
	}
	@consume[channel="test_channel2"](v) {
		println("person value = "+to_json(v))
	}
}
