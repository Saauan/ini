process main() {
	@init() {
		p1("c1")
		p2("c2")
		println("processes started")
		produce("c1", 1)
	}
	@consume[channel="c"](v) {
		println("end of pipeline: "+v)
	}
}

process p1(name) {
	@consume[channel="c1"](v) {
		println(name+": "+v)
		produce("c2", v+1)
	}
}

process p2(name) {
	@consume[channel="c2"](v) {
		println(name+": "+v)
		produce("c", v+1)
	}
}
