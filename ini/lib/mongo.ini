
import "ini/lib/core.ini"
import "ini/lib/collect.ini"

declare type MongoClient < Closeable
declare type MongoDocument < Dictionary
declare mongoClient(String) => MongoClient : [class="com.mongodb.MongoClient", member="new(..)"]
declare database(MongoClient, String) => MongoDatabase : [member="getDatabase(..)"]
declare collection(MongoDatabase, String) => MongoCollection : [member="getCollection(..)"]
declare find(MongoCollection) => Iterable : [member="find(..)"]
declare drop(MongoCollection) => Void : [member="drop(..)"]
declare insertOneDocument(MongoCollection, MongoDocument) => Void : [member="insertOne(..)"]
declare firstDocument(Iterable) => MongoDocument : [member="first(..)"]
declare(T) document(T) => MongoDocument : [class="org.bson.Document", member="new(..)"]

function insertOne(collection, data) {
	collection.insertOneDocument(document(data))
}

function fromDocument(target, document) {
	document.keys().foreach(key => {
		target[key] = document.get(key)
	})
	return target
}