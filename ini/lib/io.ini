
import "ini/lib/core.ini"

declare file(String)=>File : [class="java.io.File", member="new(..)"]
declare exists(File)=>Boolean : [member="exists(..)"]
declare is_directory(File)=>Boolean : [member="isDirectory(..)"]
declare name(File)=>String : [member="getName(..)"]
declare list(File)=>File* : [member="listFiles(..)"]
declare mkdirs(File)=>Boolean : [member="mkdirs(..)"]

declare type FileWriter < Writer
declare file_writer(File)=>FileWriter : [class="java.io.FileWriter", member="new(..)"]
declare writer_append(FileWriter,String)=>Void : [member="write(..)"]
declare writer_println(Writer,String)=>Void : [member="println(..)"]

declare file_input_stream(File)=>InputStream : [class="java.io.FileInputStream", member="new(..)"]

declare type BufferedReader < Reader
declare type DataOutputStream < OutputStream
declare reader(InputStream)=>Reader : [class="java.io.InputStreamReader", member="new(..)"]
declare buffered_reader(Reader)=>BufferedReader : [class="java.io.BufferedReader", member="new(..)"]
declare data_output_stream(OutputStream)=>DataOutputStream : [class="java.io.DataOutputStream", member="new(..)"]
declare read_line(BufferedReader)=>String : [member="readLine(..)"]
declare read_char(BufferedReader)=>Int : [member="read(..)"]
declare write_string(DataOutputStream,String)=>Void : [member="writeBytes(..)"]

function read_string(buffered_reader, count) {
	i = 0
	s = ""
	c = 0
	case i < count && c!=-1 {
		c = read_char(buffered_reader)
		s[i++] = to_char(c)
	}
	return s
}

function read_all_string(buffered_reader) {
	i = 0
	s = ""
	c = 0
	case c!=-1 {
		c = read_char(buffered_reader)
		s[i++] = to_char(c)
	}
	return s
}


/*
 * A simple function to write a string in a file.
 */
function file_write_content(file_path,string) {
	f = file_writer(file(file_path))
	writer_append(f,string)
	close(f)
}

function file_read_content(file_path) {
	fis = file_input_stream(file(file_path))
	content = read_all_string(buffered_reader(reader(fis)))
	close(fis)
	return content
}

